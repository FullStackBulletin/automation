frameworkVersion: ">=1.2.0"

service: fullstackbulletin-newsletter-V${self:custom.version}

provider:
  name: aws
  runtime: nodejs4.3
  stage: ${opt:stage}
  profile: ${opt:stage}
  region: eu-west-1
  memorySize: 512
  timeout: 120
  cfLogs: true

custom:
  version: 1

functions:
  createIssue:
    handler: handler.createIssue
    environment:
      CACHE_DIR: ${env:CACHE_DIR}
      TWITTER_SCREEN_NAMES: ${env:TWITTER_SCREEN_NAMES}
      TWITTER_CONSUMER_KEY: ${env:TWITTER_CONSUMER_KEY}
      TWITTER_CONSUMER_SECRET: ${env:TWITTER_CONSUMER_SECRET}
      TWITTER_ACCESS_TOKEN_KEY: ${env:TWITTER_ACCESS_TOKEN_KEY}
      TWITTER_ACCESS_TOKEN_SECRET: ${env:TWITTER_ACCESS_TOKEN_SECRET}
      FACEBOOK_APP_ID: ${env:FACEBOOK_APP_ID}
      FACEBOOK_APP_SECRET: ${env:FACEBOOK_APP_SECRET}
      CLOUDINARY_CLOUD_NAME: ${env:CLOUDINARY_CLOUD_NAME}
      CLOUDINARY_API_KEY: ${env:CLOUDINARY_API_KEY}
      CLOUDINARY_API_SECRET: ${env:CLOUDINARY_API_SECRET}
      CLOUDINARY_FOLDER: ${env:CLOUDINARY_FOLDER}
      MAILCHIMP_API_KEY: ${env:MAILCHIMP_API_KEY}
      MAILCHIMP_LIST_ID: ${env:MAILCHIMP_LIST_ID}
      MAILCHIMP_TEMPLATE_ID: ${env:MAILCHIMP_TEMPLATE_ID}
      MAILCHIMP_FROM_EMAIL: ${env:MAILCHIMP_FROM_EMAIL}
      MAILCHIMP_FROM_NAME: ${env:MAILCHIMP_FROM_NAME}
      MAILCHIMP_REPLY_TO_EMAIL: ${env:MAILCHIMP_REPLY_TO_EMAIL}
    events:
      - schedule: cron(0 17 ? * FRI *) # Every Friday at 5 pm
